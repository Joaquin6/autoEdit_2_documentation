## Project folder structure. - Draft  


<!--TODO: update folder structure, focus more on main components --->

As of v`1.0.6`: 

```js
.
├── LICENCE.md
├── README.md
// dmg config info 
├── appdmg.json
├── assets
// background image for dmg
│   ├── background.png
// app icon for os x dock 
│   └── nw.icns
// nwjs builder script destination folder
├── build
//build script to package the app
├── build.js
// cache folder for nwjs version to use in build 
├── cache
// some config helpers 
├── config
│   ├── README.md
│   ├── build.js
│   ├── jsdoc_conf.json
│   └── make_demo.js
├── config.js
// Jeckyll github page site for project page
├── docs
//project
├── lib
//backbone app
│   ├── app
│   │   ├── app.js
│   │   ├── collections
│   │   ├── demo_db.js
│   │   ├── helpers.js
│   │   ├── models
│   │   ├── router.js
│   │   ├── router_paperedit.js
│   │   ├── templates
│   │   └── views
// ffmpeg and ffprobe binaries 
│   ├── bin
│   │   ├── ffmpeg
│   │   └── ffprobe
│   ├── edl_composer
│   │   ├── README.md
│   │   └── index.js
//these modules are run in node context in nwjs
│   ├── interactive_transcription_generator
│   │   ├── README.md
│   │   ├── index.js
│   │   ├── transcriber
│   │   ├── video_metadata_reader
│   │   └── video_to_html5_webm
│   └── srt
│       └── index.js
├── node_modules
// nwjs packaged app
├── nwjs
//app.js is generated by browserify as part of build npm script
│   ├── app.js
│   ├── custom.css
// connect backbone.sync to db. db.js is run in node context in nwjs
│   ├── db.js
//demo data for autoEdit online demo page
│   ├── demo_paperedit.json
//demo data for autoEdit online demo page
│   ├── demo_transcription.json
//entry point for nwjs is index.html
│   ├── index.html
// module that handles the watson credentials
│   └── watson_keys.js
//node package.json file
├── package.json
// tests using jasmine
├── spec
// third party js compiled in browserify
└── vendor
    ├── backbone.async.js
    └── backbone.mousetrap.js


```


### `build.js`

Deployment script. more info on packaging and [building a new release here](/deploymentbuild.md).

### `docs` Project page
Contains a jeckyll site for the [project page, hosted on github pages](https://opennewslabs.github.io/autoEdit_2/).

Uses this template for the Landing page [pratt-app-landing-page](http://blacktie.co/2013/10/pratt-app-landing-page/) [demo](http://blacktie.co/demo/pratt)

<!-- - User manual: [jekyll-docs-template](https://github.com/bruth/jekyll-docs-template) [demo](http://bruth.github.io/jekyll-docs-template)-->


While the [user manual has been moved on gitbooks](https://pietropassarelli.gitbooks.io/autoedit2-user-manual/content)


##### Documentaiton
Was initially Using `jsdoc` and `docco`for automatic documentation generated.  See [updating documentation ](/updating-automated-documentation.md)section for more on how to update `jsdoc` and `docco`.  But have decided to [move the documentation gitbooks](https://pietropassarelli.gitbooks.io/autoedit-2-r-d-documentation-for-developers/content/) (which is what you are most likely reading now). And still need to decide what is the place, if any for automated generated documentation.


### `spec`
Test suite `npm run test`. [Uses jasmine for testing](https://jasmine.github.io/). Testes are setup to be all in one place rather then divided with their respective components, for ease of use.  Altho test coverage is far from complete and could do with some attention, s[ee supporting the project](/support-the-project.md) if that's something you'd be interested getting involved with. 

### `nwjs`
Is the front end of the project.

```js
// nwjs packaged app
├── nwjs
//app.js is generated by browserify as part of build npm script
│   ├── app.js
│   ├── custom.css
// connect backbone.sync to db. db.js is run in node context in nwjs
│   ├── db.js
//demo data for autoEdit online demo page
│   ├── demo_paperedit.json
//demo data for autoEdit online demo page
│   ├── demo_transcription.json
//entry point for nwjs is index.html
│   ├── index.html
// module that handles the watson credentials
│   └── watson_keys.js
```

`db.js` overrides `backbone.sync` method to provide a backend for the app and persistent storage using linvodb3, which uses `medeadown` to storing db on the user file system. [See current db setup tutorial for more info](/current-db-setup.md).

in `index.html` the window object is used to provide an interface between the [nwjs mixed contexts](http://docs.nwjs.io/en/latest/For%20Users/Advanced/JavaScript%20Contexts%20in%20NW.js/#mixed-context-mode) 

```js
// if require is not undefined then we are in node context in `index.html` , and therefore using 
if (typeof require !== 'undefined') {
	// other code here..
	window.DB = require('./db.js');
	//...
```

in `lib/app/app.js` the choice between the demo db and the production db is made. 

```js
// Connect up the backend for backbone
if (typeof window.DB !== 'undefined') {
  Backbone.sync = window.DB;
} else {
  Backbone.sync = require('./demo_db');
}
```

`demo_paperedit.json` and`demo_transcription.json` provide the data for the demo when `index.html` is run in client side mode in the browser. and `lib/app/demo_db.js` provides the logic for the demo db. 

## `lib`
`app` contains the backbone project. this is packaged for the client side with browserify 

```
.
├── app
│   ├── app.js
│   ├── collections
│   │   └── transcriptions.js
│   ├── demo_db.js
│   ├── helpers.js
│   ├── models
│   │   └── transcription.js
│   ├── router.js
│   ├── templates
│   │   ├── 404.html.ejs
│   │   ├── home_page.html.ejs
│   │   ├── transcription_form_template.html.ejs
│   │   ├── transcription_index.html.ejs
│   │   ├── transcription_show.html.ejs
│   │   └── welcome.html.ejs
│   └── views
│       ├── transcription_form_view.js
│       ├── transcription_list_element_view.js
│       ├── transcription_list_view.js
│       ├── transcription_view.js
│       └── utils.js
├── edl_composer
│   ├── README.md
│   └── index.js
├── interactive_transcription_generator
│   ├── README.md
│   ├── index.js
│   ├── transcriber
│   │   ├── README.md
│   │   ├── convert_to_audio.js
│   │   ├── examples
│   │   ├── gentle_stt_node
│   │   ├── ibm_stt_node
│   │   ├── index.js
│   │   ├── split.js
│   │   └── trimmer.js
│   ├── video_metadata_reader
│   │   ├── README.md
│   │   ├── examples
│   │   └── index.js
│   └── video_to_html5_webm
│       └── index.js
└── srt
    └── index.js
```


### `interactive_transcription_generator`

After the user uploads a video or audio file the backbone app uses `autoEdit2API.js` to override default [`backbone.sync`][backbonesync].
 
- The app converts the file to an audio file meet the IBM Watson STT Specs
- if greater then 5 min long it splits it into 5 min chunk 
	- keeps tracks of the time offset of each clip 
- sends audio files to IBM STT API
- if submitted file was greater then 5 min
	- when results starts to come back as json after about 5 min or less results are re-interpolated into one json file
- json returned by IBM is converted into json meeting autoEdit2 specs and saved
- user can now view interactive transcription


As you might have guessed the module responsable for "post-processing" the audio and video file and get the transcription from IBM is called `interactive_transcription_generator`.

On top of prepping the audio or video file to get a transcription from IBM, it also generates a webm html5 video preview and reads the metadata, which is something needed make an [EDL][edl].


```
├── interactive_transcription_generator
	├── README.md
	├── bin
	│   ├── ffmpeg
	│   └── ffprobe
	├── index.js
	├── transcriber
	│   ├── README.md
	│   ├── convert_to_audio.js
	│   ├── examples
	│   ├── gentle_stt_node
	│   ├── ibm_stt_node
	│   ├── index.js
	│   ├── split.js
	│   └── trimmer.js
	├── video_metadata_reader
	│   ├── README.md
	│   ├── examples
	│   └── index.js
	└── video_to_html5_webm
	    └── index.js
```

[nwjs]: http://docs.nwjs.io/en/latest/For%20Users/Getting%20Started/
[node]:https://nodejs.org/en/
[backbone]:http://backbonejs.org/
[usermanual]:/user_manual/usage.html
[backbonesync]:http://backbonejs.org/#Sync
[edl]:/jsdoc_docs/tutorial-EDL_format.html
[autoEdit2Github]:https://github.com/OpenNewsLabs/autoEdit_2
[jeckyll]:https://jekyllrb.com/ 
[jsdoc]:http://usejsdoc.org/
[docco]:https://jashkenas.github.io/docco/